# Tracker-Specific Rules

`mkbrr` includes built-in knowledge about the specific requirements of various private trackers to help ensure the torrents you create are compliant. When you provide a tracker URL (`-t` flag or via presets/batch), `mkbrr` checks if it matches a known tracker and applies relevant rules automatically.

## How it Works

When creating a torrent, `mkbrr` compares the provided tracker URL against an internal list of configurations. If a match is found, it applies the corresponding rules regarding:

1.  **Maximum Piece Length:** Enforces an upper limit on the piece size (e.g., 16 MiB, 8 MiB). If automatic calculation or a manually specified piece length (`-l`, `-m`) exceeds this limit, `mkbrr` caps it at the tracker's maximum.
2.  **Recommended Piece Size Ranges:** Selects a specific piece size based on the total content size, overriding the default automatic calculation (e.g., use 1 MiB pieces for content between 1-2 GB). If verbose mode (`-v`) is enabled, `mkbrr` will indicate when it's using a tracker-specific range.
3.  **Maximum `.torrent` File Size:** If the generated `.torrent` file would exceed a tracker's limit (e.g., 250 KiB for Anthelion), `mkbrr` automatically attempts to increase the piece length (up to a practical maximum of 16 MiB / 2^24) to reduce the number of piece hashes and thus the overall file size. If the limit still cannot be met, creation will fail.

## Handled Rules Summary

Here's a summary of the rules `mkbrr` currently handles based on its internal configuration:

*   **Max Piece Length:**
    *   **64 MiB (2^26):** GazelleGames (`gazellegames.net`)
    *   **16 MiB (2^24):** HDBits (`hdbits.org`), BeyondHD (`beyond-hd.me`), PassThePopcorn (`passthepopcorn.me`), SuperBits (`superbits.org`), Torrent Syndicate (`torrent-syndikat.org`, `tee-stube.org`), landof.tv, Norbits (`norbits.net`), SPTracker (`sptracker.cc`)
    *   **8 MiB (2^23):** Empornium (`empornium.sx`), MoreThanTV (`morethantv.me`)
*   **Piece Size Ranges:** Specific ranges based on content size are used for trackers like PassThePopcorn, GazelleGames, Norbits, landof.tv, Torrent Syndicate. (See source code below for details).
*   **Max Torrent Size:**
    *   **250 KiB:** Anthelion (`anthelion.me`)
    *   **1 MiB:** GazelleGames (`gazellegames.net`)

## Configuration Source (`internal/trackers/trackers.go`)

The specific rules and tracker URLs are defined within the `mkbrr` source code in the `trackerConfigs` variable. You can view the exact configuration below or directly in the [GitHub repository](https://github.com/autobrr/mkbrr/blob/main/internal/trackers/trackers.go).

```go
package trackers

import "strings"

// TrackerConfig holds tracker-specific configuration
type TrackerConfig struct {
	URLs             []string         // list of tracker URLs that share this config
	MaxPieceLength   uint             // maximum piece length exponent (2^n)
	PieceSizeRanges  []PieceSizeRange // custom piece size ranges for specific content sizes
	UseDefaultRanges bool             // whether to use default piece size ranges when content size is outside custom ranges
	MaxTorrentSize   uint64           // maximum .torrent file size in bytes (0 means no limit)
}

// PieceSizeRange defines a range of content sizes and their corresponding piece size exponent
type PieceSizeRange struct {
	MaxSize  uint64 // maximum content size in bytes for this range
	PieceExp uint   // piece size exponent (2^n)
}

// trackerConfigs maps known tracker base URLs to their configurations
var trackerConfigs = []TrackerConfig{
	{
		URLs: []string{
			"anthelion.me",
		},
		MaxTorrentSize: 250 << 10, // 250 KiB torrent file size limit
	},
	{
		URLs: []string{
			"hdbits.org",
			"beyond-hd.me",
			"superbits.org",
			"sptracker.cc",
		},
		MaxPieceLength:   24, // max 16 MiB pieces (2^24)
		UseDefaultRanges: true,
	},
	{
		URLs: []string{
			"passthepopcorn.me",
		}, // https://ptp/upload.php?action=piecesize
		MaxPieceLength: 24, // max 16 MiB pieces (2^24)
		PieceSizeRanges: []PieceSizeRange{
			{MaxSize: 58 << 20, PieceExp: 16},    // 64 KiB for <= 58 MiB
			{MaxSize: 122 << 20, PieceExp: 17},   // 128 KiB for 58-122 MiB
			{MaxSize: 213 << 20, PieceExp: 18},   // 256 KiB for 122-213 MiB
			{MaxSize: 444 << 20, PieceExp: 19},   // 512 KiB for 213-444 MiB
			{MaxSize: 922 << 20, PieceExp: 20},   // 1 MiB for 444-922 MiB
			{MaxSize: 3977 << 20, PieceExp: 21},  // 2 MiB for 922 MiB-3.88 GiB
			{MaxSize: 6861 << 20, PieceExp: 22},  // 4 MiB for 3.88-6.70 GiB
			{MaxSize: 14234 << 20, PieceExp: 23}, // 8 MiB for 6.70-13.90 GiB
			{MaxSize: ^uint64(0), PieceExp: 24},  // 16 MiB for > 13.90 GiB
		},
		UseDefaultRanges: false,
	},
	{
		URLs: []string{
			"empornium.sx",
			"morethantv.me", // https://mtv/forum/thread/3237?postid=74725#post74725
		},
		MaxPieceLength:   23, // max 8 MiB pieces (2^23)
		UseDefaultRanges: true,
	},
	{
		URLs: []string{
			"gazellegames.net",
		},
		MaxPieceLength: 26, // max 64 MiB pieces (2^26)
		PieceSizeRanges: []PieceSizeRange{ // https://ggn/wiki.php?action=article&id=300
			{MaxSize: 64 << 20, PieceExp: 15},    // 32 KiB for < 64 MB
			{MaxSize: 128 << 20, PieceExp: 16},   // 64 KiB for 64-128 MB
			{MaxSize: 256 << 20, PieceExp: 17},   // 128 KiB for 128-256 MB
			{MaxSize: 512 << 20, PieceExp: 18},   // 256 KiB for 256-512 MB
			{MaxSize: 1024 << 20, PieceExp: 19},  // 512 KiB for 512 MB-1 GB
			{MaxSize: 2048 << 20, PieceExp: 20},  // 1 MiB for 1-2 GB
			{MaxSize: 4096 << 20, PieceExp: 21},  // 2 MiB for 2-4 GB
			{MaxSize: 8192 << 20, PieceExp: 22},  // 4 MiB for 4-8 GB
			{MaxSize: 16384 << 20, PieceExp: 23}, // 8 MiB for 8-16 GB
			{MaxSize: 32768 << 20, PieceExp: 24}, // 16 MiB for 16-32 GB
			{MaxSize: 65536 << 20, PieceExp: 25}, // 32 MiB for 32-64 GB
			{MaxSize: ^uint64(0), PieceExp: 26},  // 64 MiB for > 64 GB
		},
		UseDefaultRanges: false,
		MaxTorrentSize:   1 << 20, // 1 MB torrent file size limit
	},
	{
		URLs: []string{
			"norbits.net",
		},
		PieceSizeRanges: []PieceSizeRange{ // https://nb/ulguide.php
			{MaxSize: 250 << 20, PieceExp: 18},   // 256 KiB for < 250 MB
			{MaxSize: 1024 << 20, PieceExp: 20},  // 1 MiB for 250-1024 MB
			{MaxSize: 5120 << 20, PieceExp: 21},  // 2 MiB for 1-5 GB
			{MaxSize: 20480 << 20, PieceExp: 22}, // 4 MiB for 5-20 GB
			{MaxSize: 40960 << 20, PieceExp: 23}, // 8 MiB for 20-40 GB
			{MaxSize: ^uint64(0), PieceExp: 24},  // 16 MiB for > 40 GB
		},
		MaxPieceLength:   24, // max 16 MiB pieces (2^24)
		UseDefaultRanges: false,
	},
	{
		URLs: []string{
			"landof.tv",
		},
		PieceSizeRanges: []PieceSizeRange{ // https://btn/forums.php?action=viewthread&threadid=18301
			{MaxSize: 32 << 20, PieceExp: 15},   // 32 KiB for <= 32 MiB
			{MaxSize: 62 << 20, PieceExp: 16},   // 64 KiB for 32-62 MiB
			{MaxSize: 125 << 20, PieceExp: 17},  // 128 KiB for 62-125 MiB
			{MaxSize: 250 << 20, PieceExp: 18},  // 256 KiB for 125-250 MiB
			{MaxSize: 500 << 20, PieceExp: 19},  // 512 KiB for 250-500 MiB
			{MaxSize: 1000 << 20, PieceExp: 20}, // 1 MiB for 500-1000 MiB
			{MaxSize: 1945 << 20, PieceExp: 21}, // 2 MiB for 1000 MiB-1.95 GiB
			{MaxSize: 3906 << 20, PieceExp: 22}, // 4 MiB for 1.95-3.906 GiB
			{MaxSize: 7810 << 20, PieceExp: 23}, // 8 MiB for 3.906-7.81 GiB
			{MaxSize: ^uint64(0), PieceExp: 24}, // 16 MiB for > 7.81 GiB
		},
		MaxPieceLength:   24, // max 16 MiB pieces (2^24)
		UseDefaultRanges: false,
	},
	{
		URLs: []string{
			"torrent-syndikat.org",
			"tee-stube.org",
		},
		MaxPieceLength: 24, // max 16 MiB pieces (2^24)
		PieceSizeRanges: []PieceSizeRange{
			{MaxSize: 250 << 20, PieceExp: 20},   // 1 MiB for < 250 MB
			{MaxSize: 1024 << 20, PieceExp: 20},  // 1 MiB for 250 MB-1 GB
			{MaxSize: 5120 << 20, PieceExp: 20},  // 1 MiB for 1-5 GB
			{MaxSize: 20480 << 20, PieceExp: 22}, // 4 MiB for 5-20 GB
			{MaxSize: 51200 << 20, PieceExp: 23}, // 8 MiB for 20-50 GB
			{MaxSize: ^uint64(0), PieceExp: 24},  // 16 MiB for > 50 GB
		},
		UseDefaultRanges: false,
	},
}

// ... (helper functions findTrackerConfig, GetTrackerMaxPieceLength, etc. would follow)
```

<Info>
This configuration is subject to change as tracker rules evolve. Contributions to keep this list accurate are welcome via pull requests to the `mkbrr` repository.
</Info>
